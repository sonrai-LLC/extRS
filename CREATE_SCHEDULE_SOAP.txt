using System;  
using System.Collections.Generic;  
using System.IO;  
using System.Text;  
using System.Web;  
using System.Web.Services;  
using System.Web.Services.Protocols;  

class Sample  
{  
    static void Main(string[] args)  
    {  
        ReportingService2010 rs = new ReportingService2010();  
        rs.Url = "http://<Server Name>" +  
            "/_vti_bin/ReportServer/ReportService2010.asmx";  
        rs.Credentials =   
            System.Net.CredentialCache.DefaultCredentials;  

        ScheduleDefinition definition = new ScheduleDefinition();  
        string scheduleID = "";  

        // Create the schedule definition.  
        definition.StartDateTime =   
            new DateTime(2003, 3, 1, 14, 0, 0);  
        WeeklyRecurrence recurrence = new WeeklyRecurrence();  
        DaysOfWeekSelector days = new DaysOfWeekSelector();  
        days.Monday = true;  
        days.Tuesday = true;  
        days.Wednesday = true;  
        days.Thursday = true;  
        days.Friday = true;  
        days.Saturday = false;  
        days.Sunday = false;  
        recurrence.DaysOfWeek = days;  
        recurrence.WeeksInterval = 1;  
        recurrence.WeeksIntervalSpecified = true;  
        definition.Item = recurrence;  

        try  
        {  
            string site = "http://<Server Name>";  

            scheduleID = rs.CreateSchedule("My Schedule",   
                definition, site);  
            Console.WriteLine("Schedule created with ID {0}",   
                scheduleID);  
        }  
        catch (SoapException e)  
        {  
            Console.WriteLine(e.Detail.InnerXml.ToString());  
        }  
    }  
}  